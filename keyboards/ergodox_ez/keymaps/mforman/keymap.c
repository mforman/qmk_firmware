#include "mforman.h"  // in users/mforman

// clang-format off
#define LAYOUT_ergodox_pretty_wrapper(...)   LAYOUT_ergodox_pretty(__VA_ARGS__)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
[_QWERTY] = LAYOUT_ergodox_pretty_wrapper(
_______, ________________NUMBER_LEFT________________, _______,      _______, ________________NUMBER_RIGHT_______________, _______,
_______, _________________QWERTY_L1_________________, _______,      _______, _________________QWERTY_R1_________________, _______,
_______, _________________QWERTY_L2_________________,                        _________________QWERTY_R2_________________, _______,
_______, _________________QWERTY_L3_________________, _______,      _______, _________________QWERTY_R3_________________, _______,
_______, _______, _______, _______, TC_ESC ,                                          TC_DEL , _______, _______, _______, _______,

                                            _______, _______,       _______, _______,
                                                     _______,       _______,
                                    TC_SPC , TC_TAB, _______,       _______, TC_ENT , TC_BSP
),

[_WINDOWS] = LAYOUT_ergodox_pretty_wrapper(
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, ___________________BLANK___________________,                        ___________________BLANK___________________, _______,
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, _______, _______, _______, LCTL_T(KC_ESC),                                   _______, _______, _______, _______, _______,

                                             _______, _______,       _______, _______,
                                                      _______,       _______,
                           LGUI_T(KC_SPACE), _______, _______,       _______, _______, _______
),

[_LOWER] = LAYOUT_ergodox_pretty_wrapper(
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, _________________LOWER_L1__________________, _______,      _______, _________________LOWER_R1__________________, _______,
_______, _________________LOWER_L2__________________,                        _________________LOWER_R2__________________, _______,
_______, _________________LOWER_L3__________________, _______,      _______, _________________LOWER_R3__________________, _______,
_______, _______, _______, _______, _______,                                          KC_BTN2, _______, _______, _______, _______,

                                             _______, _______,      _______, _______,
                                                      _______,      _______,
                                    _______, _______, _______,      _______, _______, KC_BTN1
),

[_RAISE] = LAYOUT_ergodox_pretty_wrapper(
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, _________________RAISE_L1__________________, _______,      _______, _________________RAISE_R1__________________, _______,
_______, _________________RAISE_L2__________________,                        _________________RAISE_R2__________________, _______,
_______, _________________RAISE_L3__________________, _______,      _______, _________________RAISE_R3__________________, _______,
_______, _______, _______, _______, KC_DOT ,                                          _______, _______, _______, _______, _______,

                                             _______, _______,      _______, _______,
                                                      _______,      _______,
                                    KC_0   , _______, _______,      _______, _______, _______
),

[_ADJUST] = LAYOUT_ergodox_pretty_wrapper(
_______, ___________________BLANK___________________, _______,      _______, ___________________BLANK___________________, _______,
_______, ___________________BLANK___________________, _______,      _______, ________________ADJUST_R1__________________, _______,
_______, ___________________BLANK___________________,                        ________________ADJUST_R2__________________, _______,
_______, ___________________BLANK___________________, _______,      _______, ________________ADJUST_R3__________________, _______,
_______, _______, _______, _______, _______,                                          _______, _______, _______, _______, _______,

                                             _______, _______,      _______, _______,
                                                      _______,      _______,
                                    _______, _______, _______,      _______, _______, _______
)
};

// clang-format on

uint32_t layer_state_set_keymap(uint32_t state) {
    uint8_t layer = biton32(state);
    ergodox_board_led_off();
    ergodox_right_led_1_off();
    ergodox_right_led_2_off();
    ergodox_right_led_3_off();
    switch (layer) {
        case _WINDOWS:
            ergodox_right_led_2_on();
            break;
        case _LOWER:
            ergodox_right_led_3_on();
            break;
        case _RAISE:
            ergodox_right_led_1_on();
            break;
        case _ADJUST:
            ergodox_right_led_1_on();
            ergodox_right_led_3_on();
            break;
        default:
            break;
    }
    return state;
};
